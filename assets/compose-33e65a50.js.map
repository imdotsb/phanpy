{"version":3,"file":"compose-33e65a50.js","sources":["../../src/compose.jsx"],"sourcesContent":["import './index.css';\r\n\r\nimport './app.css';\r\n\r\nimport { render } from 'preact';\r\nimport { useEffect, useState } from 'preact/hooks';\r\n\r\nimport Compose from './components/compose';\r\nimport useTitle from './utils/useTitle';\r\n\r\nif (window.opener) {\r\n  console = window.opener.console;\r\n}\r\n\r\nfunction App() {\r\n  const [uiState, setUIState] = useState('default');\r\n\r\n  const { editStatus, replyToStatus, draftStatus } = window.__COMPOSE__ || {};\r\n\r\n  useTitle(\r\n    editStatus\r\n      ? 'Editing source status'\r\n      : replyToStatus\r\n      ? `Replying to @${\r\n          replyToStatus.account?.acct || replyToStatus.account?.username\r\n        }`\r\n      : 'Compose',\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (uiState === 'closed') {\r\n      try {\r\n        // Focus parent window\r\n        window.opener.focus();\r\n      } catch (e) {}\r\n      window.close();\r\n    }\r\n  }, [uiState]);\r\n\r\n  if (uiState === 'closed') {\r\n    return (\r\n      <div class=\"box\">\r\n        <p>You may close this page now.</p>\r\n        <p>\r\n          <button\r\n            onClick={() => {\r\n              window.close();\r\n            }}\r\n          >\r\n            Close window\r\n          </button>\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  console.debug('OPEN COMPOSE');\r\n\r\n  return (\r\n    <Compose\r\n      editStatus={editStatus}\r\n      replyToStatus={replyToStatus}\r\n      draftStatus={draftStatus}\r\n      standalone\r\n      hasOpener={window.opener}\r\n      onClose={(results) => {\r\n        const { newStatus, fn = () => {} } = results || {};\r\n        try {\r\n          if (newStatus) {\r\n            window.opener.__STATES__.reloadStatusPage++;\r\n          }\r\n          fn();\r\n          setUIState('closed');\r\n        } catch (e) {}\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\nrender(<App />, document.getElementById('app-standalone'));\r\n"],"names":["window","opener","console","App","uiState","setUIState","useState","editStatus","replyToStatus","draftStatus","__COMPOSE__","account","acct","username","useEffect","focus","close","_jsxs","class","children","_jsx","onClick","standalone","hasOpener","newStatus","results","fn","render"],"mappings":"gHAUIA,OAAOC,SACTC,QAAUF,OAAOC,OAAOC,SAG1B,SAASC,GAAM,SACb,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAS,SAAS,EAE1C,CAAEC,WAAAA,EAAYC,cAAAA,EAAeC,YAAAA,CAAAA,EAAgBT,OAAOU,aAAe,GAsBzE,OAnBEH,EAAAA,EACI,wBACAC,EACC,kBACCA,EAAAA,EAAcG,UAAdH,YAAAA,EAAuBI,SAAQJ,EAAAA,EAAcG,UAAdH,YAAAA,EAAuBK,SACvD,GACD,SACN,EAEAC,EAAU,IAAM,CACd,GAAIV,IAAY,SAAU,CACpB,GAAA,CAEFJ,OAAOC,OAAOc,aACJ,CAAC,CACbf,OAAOgB,MAAM,CACf,CAAA,EACC,CAACZ,CAAO,CAAC,EAERA,IAAY,SAEZa,EAAA,MAAA,CAAKC,MAAM,MAAKC,UACdC,EAAA,IAAA,CAAAD,SAAG,8BAAA,CAA+B,EAClCC,EAAA,IAAA,CAAAD,SACEC,EAAA,SAAA,CACEC,QAASA,IAAM,CACbrB,OAAOgB,MAAM,CACf,EAAEG,SACH,cAAA,CAEO,CAAA,CACP,CAAC,CAAA,CACD,EAITjB,IAA4B,CAE5B,WAAAK,EAEIA,cAAAA,EACAC,YAAAA,EACAC,WAAAA,GACAa,UAAU,OAAA,OACVC,WAAkBtB,OAEV,UAAAuB,EAAEA,GAAAA,EAAAA,IAAAA,EAAsB,EAACC,GAAA,CAAA,EAAE,GAAIA,CACjCD,GACF,OAAe,OAAA,WAAA,mBAEfE,IACGrB,EAAA,QAAA,CACHA,MAAAA,EACW,CAAA,CACf,CAAA,CAGNsB,EAAAP,EAAAjB,EAAA,CAAA,CAAA,EAAA,SAAA,eAAA,gBAAA,CAAA"}