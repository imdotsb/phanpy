{"version":3,"file":"modals-XYpds0X8.js","sources":["../../src/pages/accounts.jsx","../../src/pages/settings.jsx","../../src/utils/useLocationChange.js","../../src/components/account-sheet.jsx","../../src/components/drafts.jsx","../../src/components/embed-modal.jsx","../../src/components/generic-accounts.jsx","../../src/components/media-alt-modal.jsx","../../src/components/report-modal.jsx","../../src/components/modals.jsx"],"sourcesContent":["import './accounts.css';\r\n\r\nimport { useAutoAnimate } from '@formkit/auto-animate/preact';\r\nimport { Menu, MenuDivider, MenuItem } from '@szhsin/react-menu';\r\nimport { useReducer } from 'preact/hooks';\r\n\r\nimport Avatar from '../components/avatar';\r\nimport Icon from '../components/icon';\r\nimport Link from '../components/link';\r\nimport Menu2 from '../components/menu2';\r\nimport MenuConfirm from '../components/menu-confirm';\r\nimport NameText from '../components/name-text';\r\nimport { api } from '../utils/api';\r\nimport states from '../utils/states';\r\nimport store from '../utils/store';\r\n\r\nfunction Accounts({ onClose }) {\r\n  const { masto } = api();\r\n  // Accounts\r\n  const accounts = store.local.getJSON('accounts');\r\n  const currentAccount = store.session.get('currentAccount');\r\n  const moreThanOneAccount = accounts.length > 1;\r\n\r\n  const [_, reload] = useReducer((x) => x + 1, 0);\r\n  const [accountsListParent] = useAutoAnimate();\r\n\r\n  return (\r\n    <div id=\"accounts-container\" class=\"sheet\" tabIndex=\"-1\">\r\n      {!!onClose && (\r\n        <button type=\"button\" class=\"sheet-close\" onClick={onClose}>\r\n          <Icon icon=\"x\" />\r\n        </button>\r\n      )}\r\n      <header class=\"header-grid\">\r\n        <h2>Accounts</h2>\r\n      </header>\r\n      <main>\r\n        <section>\r\n          <ul class=\"accounts-list\" ref={accountsListParent}>\r\n            {accounts.map((account, i) => {\r\n              const isCurrent = account.info.id === currentAccount;\r\n              const isDefault = i === 0; // first account is always default\r\n              return (\r\n                <li key={account.info.id}>\r\n                  <div>\r\n                    {moreThanOneAccount && (\r\n                      <span class={`current ${isCurrent ? 'is-current' : ''}`}>\r\n                        <Icon icon=\"check-circle\" alt=\"Current\" />\r\n                      </span>\r\n                    )}\r\n                    <Avatar\r\n                      url={account.info.avatarStatic}\r\n                      size=\"xxl\"\r\n                      onDblClick={async () => {\r\n                        if (isCurrent) {\r\n                          try {\r\n                            const info = await masto.v1.accounts\r\n                              .$select(account.info.id)\r\n                              .fetch();\r\n                            console.log('fetched account info', info);\r\n                            account.info = info;\r\n                            store.local.setJSON('accounts', accounts);\r\n                            reload();\r\n                          } catch (e) {}\r\n                        }\r\n                      }}\r\n                    />\r\n                    <NameText\r\n                      account={\r\n                        moreThanOneAccount\r\n                          ? {\r\n                              ...account.info,\r\n                              acct: /@/.test(account.info.acct)\r\n                                ? account.info.acct\r\n                                : `${account.info.acct}@${account.instanceURL}`,\r\n                            }\r\n                          : account.info\r\n                      }\r\n                      showAcct\r\n                      onClick={() => {\r\n                        if (isCurrent) {\r\n                          states.showAccount = `${account.info.username}@${account.instanceURL}`;\r\n                        } else {\r\n                          store.session.set('currentAccount', account.info.id);\r\n                          location.reload();\r\n                        }\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <div class=\"actions\">\r\n                    {isDefault && moreThanOneAccount && (\r\n                      <>\r\n                        <span class=\"tag\">Default</span>{' '}\r\n                      </>\r\n                    )}\r\n                    <Menu2\r\n                      align=\"end\"\r\n                      menuButton={\r\n                        <button\r\n                          type=\"button\"\r\n                          title=\"More\"\r\n                          class=\"plain more-button\"\r\n                        >\r\n                          <Icon icon=\"more\" size=\"l\" alt=\"More\" />\r\n                        </button>\r\n                      }\r\n                    >\r\n                      <MenuItem\r\n                        onClick={() => {\r\n                          states.showAccount = `${account.info.username}@${account.instanceURL}`;\r\n                        }}\r\n                      >\r\n                        <Icon icon=\"user\" />\r\n                        <span>View profile…</span>\r\n                      </MenuItem>\r\n                      <MenuDivider />\r\n                      {moreThanOneAccount && (\r\n                        <MenuItem\r\n                          disabled={isDefault}\r\n                          onClick={() => {\r\n                            // Move account to the top of the list\r\n                            accounts.splice(i, 1);\r\n                            accounts.unshift(account);\r\n                            store.local.setJSON('accounts', accounts);\r\n                            reload();\r\n                          }}\r\n                        >\r\n                          <Icon icon=\"check-circle\" />\r\n                          <span>Set as default</span>\r\n                        </MenuItem>\r\n                      )}\r\n                      <MenuConfirm\r\n                        subMenu\r\n                        confirmLabel={\r\n                          <>\r\n                            <Icon icon=\"exit\" />\r\n                            <span>Log out @{account.info.acct}?</span>\r\n                          </>\r\n                        }\r\n                        disabled={!isCurrent}\r\n                        menuItemClassName=\"danger\"\r\n                        onClick={() => {\r\n                          // const yes = confirm('Log out?');\r\n                          // if (!yes) return;\r\n                          accounts.splice(i, 1);\r\n                          store.local.setJSON('accounts', accounts);\r\n                          // location.reload();\r\n                          location.href = location.pathname || '/';\r\n                        }}\r\n                      >\r\n                        <Icon icon=\"exit\" />\r\n                        <span>Log out…</span>\r\n                      </MenuConfirm>\r\n                    </Menu2>\r\n                  </div>\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n          <p>\r\n            <Link to=\"/login\" class=\"button plain2\" onClick={onClose}>\r\n              <Icon icon=\"plus\" /> <span>Add an existing account</span>\r\n            </Link>\r\n          </p>\r\n          {moreThanOneAccount && (\r\n            <p>\r\n              <small>\r\n                Note: <i>Default</i> account will always be used for first load.\r\n                Switched accounts will persist during the session.\r\n              </small>\r\n            </p>\r\n          )}\r\n        </section>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Accounts;\r\n","import './settings.css';\r\n\r\nimport { useEffect, useRef, useState } from 'preact/hooks';\r\nimport { useSnapshot } from 'valtio';\r\n\r\nimport logo from '../assets/logo.svg';\r\n\r\nimport Icon from '../components/icon';\r\nimport Link from '../components/link';\r\nimport RelativeTime from '../components/relative-time';\r\nimport targetLanguages from '../data/lingva-target-languages';\r\nimport { api } from '../utils/api';\r\nimport getTranslateTargetLanguage from '../utils/get-translate-target-language';\r\nimport localeCode2Text from '../utils/localeCode2Text';\r\nimport {\r\n  initSubscription,\r\n  isPushSupported,\r\n  removeSubscription,\r\n  updateSubscription,\r\n} from '../utils/push-notifications';\r\nimport showToast from '../utils/show-toast';\r\nimport states from '../utils/states';\r\nimport store from '../utils/store';\r\n\r\nconst DEFAULT_TEXT_SIZE = 16;\r\nconst TEXT_SIZES = [14, 15, 16, 17, 18, 19, 20];\r\nconst {\r\n  PHANPY_WEBSITE: WEBSITE,\r\n  PHANPY_PRIVACY_POLICY_URL: PRIVACY_POLICY_URL,\r\n  PHANPY_IMG_ALT_API_URL: IMG_ALT_API_URL,\r\n} = import.meta.env;\r\n\r\nfunction Settings({ onClose }) {\r\n  const snapStates = useSnapshot(states);\r\n  const currentTheme = store.local.get('theme') || 'auto';\r\n  const themeFormRef = useRef();\r\n  const targetLanguage =\r\n    snapStates.settings.contentTranslationTargetLanguage || null;\r\n  const systemTargetLanguage = getTranslateTargetLanguage();\r\n  const systemTargetLanguageText = localeCode2Text(systemTargetLanguage);\r\n  const currentTextSize = store.local.get('textSize') || DEFAULT_TEXT_SIZE;\r\n\r\n  const [prefs, setPrefs] = useState(store.account.get('preferences') || {});\r\n  const { masto, authenticated, instance } = api();\r\n  // Get preferences every time Settings is opened\r\n  // NOTE: Disabled for now because I don't expect this to change often. Also for some reason, the /api/v1/preferences endpoint is cached for a while and return old prefs if refresh immediately after changing them.\r\n  // useEffect(() => {\r\n  //   const { masto } = api();\r\n  //   (async () => {\r\n  //     try {\r\n  //       const preferences = await masto.v1.preferences.fetch();\r\n  //       setPrefs(preferences);\r\n  //       store.account.set('preferences', preferences);\r\n  //     } catch (e) {\r\n  //       // Silently fail\r\n  //       console.error(e);\r\n  //     }\r\n  //   })();\r\n  // }, []);\r\n\r\n  return (\r\n    <div id=\"settings-container\" class=\"sheet\" tabIndex=\"-1\">\r\n      {!!onClose && (\r\n        <button type=\"button\" class=\"sheet-close\" onClick={onClose}>\r\n          <Icon icon=\"x\" />\r\n        </button>\r\n      )}\r\n      <header>\r\n        <h2>Settings</h2>\r\n      </header>\r\n      <main>\r\n        <section>\r\n          <ul>\r\n            <li>\r\n              <div>\r\n                <label>Appearance</label>\r\n              </div>\r\n              <div>\r\n                <form\r\n                  ref={themeFormRef}\r\n                  onInput={(e) => {\r\n                    console.log(e);\r\n                    e.preventDefault();\r\n                    const formData = new FormData(themeFormRef.current);\r\n                    const theme = formData.get('theme');\r\n                    const html = document.documentElement;\r\n\r\n                    if (theme === 'auto') {\r\n                      html.classList.remove('is-light', 'is-dark');\r\n\r\n                      // Disable manual theme <meta>\r\n                      const $manualMeta = document.querySelector(\r\n                        'meta[data-theme-setting=\"manual\"]',\r\n                      );\r\n                      if ($manualMeta) {\r\n                        $manualMeta.name = '';\r\n                      }\r\n                      // Enable auto theme <meta>s\r\n                      const $autoMetas = document.querySelectorAll(\r\n                        'meta[data-theme-setting=\"auto\"]',\r\n                      );\r\n                      $autoMetas.forEach((m) => {\r\n                        m.name = 'theme-color';\r\n                      });\r\n                    } else {\r\n                      html.classList.toggle('is-light', theme === 'light');\r\n                      html.classList.toggle('is-dark', theme === 'dark');\r\n\r\n                      // Enable manual theme <meta>\r\n                      const $manualMeta = document.querySelector(\r\n                        'meta[data-theme-setting=\"manual\"]',\r\n                      );\r\n                      if ($manualMeta) {\r\n                        $manualMeta.name = 'theme-color';\r\n                        $manualMeta.content =\r\n                          theme === 'light'\r\n                            ? $manualMeta.dataset.themeLightColor\r\n                            : $manualMeta.dataset.themeDarkColor;\r\n                      }\r\n                      // Disable auto theme <meta>s\r\n                      const $autoMetas = document.querySelectorAll(\r\n                        'meta[data-theme-setting=\"auto\"]',\r\n                      );\r\n                      $autoMetas.forEach((m) => {\r\n                        m.name = '';\r\n                      });\r\n                    }\r\n                    document\r\n                      .querySelector('meta[name=\"color-scheme\"]')\r\n                      .setAttribute(\r\n                        'content',\r\n                        theme === 'auto' ? 'dark light' : theme,\r\n                      );\r\n\r\n                    if (theme === 'auto') {\r\n                      store.local.del('theme');\r\n                    } else {\r\n                      store.local.set('theme', theme);\r\n                    }\r\n                  }}\r\n                >\r\n                  <div class=\"radio-group\">\r\n                    <label>\r\n                      <input\r\n                        type=\"radio\"\r\n                        name=\"theme\"\r\n                        value=\"light\"\r\n                        defaultChecked={currentTheme === 'light'}\r\n                      />\r\n                      <span>Light</span>\r\n                    </label>\r\n                    <label>\r\n                      <input\r\n                        type=\"radio\"\r\n                        name=\"theme\"\r\n                        value=\"dark\"\r\n                        defaultChecked={currentTheme === 'dark'}\r\n                      />\r\n                      <span>Dark</span>\r\n                    </label>\r\n                    <label>\r\n                      <input\r\n                        type=\"radio\"\r\n                        name=\"theme\"\r\n                        value=\"auto\"\r\n                        defaultChecked={\r\n                          currentTheme !== 'light' && currentTheme !== 'dark'\r\n                        }\r\n                      />\r\n                      <span>Auto</span>\r\n                    </label>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </li>\r\n            <li>\r\n              <div>\r\n                <label>Text size</label>\r\n              </div>\r\n              <div class=\"range-group\">\r\n                <span style={{ fontSize: TEXT_SIZES[0] }}>A</span>{' '}\r\n                <input\r\n                  type=\"range\"\r\n                  min={TEXT_SIZES[0]}\r\n                  max={TEXT_SIZES[TEXT_SIZES.length - 1]}\r\n                  step=\"1\"\r\n                  value={currentTextSize}\r\n                  list=\"sizes\"\r\n                  onChange={(e) => {\r\n                    const value = parseInt(e.target.value, 10);\r\n                    const html = document.documentElement;\r\n                    // set CSS variable\r\n                    html.style.setProperty('--text-size', `${value}px`);\r\n                    // save to local storage\r\n                    if (value === DEFAULT_TEXT_SIZE) {\r\n                      store.local.del('textSize');\r\n                    } else {\r\n                      store.local.set('textSize', e.target.value);\r\n                    }\r\n                  }}\r\n                />{' '}\r\n                <span style={{ fontSize: TEXT_SIZES[TEXT_SIZES.length - 1] }}>\r\n                  A\r\n                </span>\r\n                <datalist id=\"sizes\">\r\n                  {TEXT_SIZES.map((size) => (\r\n                    <option value={size} />\r\n                  ))}\r\n                </datalist>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </section>\r\n        {authenticated && (\r\n          <>\r\n            <h3>Posting</h3>\r\n            <section>\r\n              <ul>\r\n                <li>\r\n                  <div>\r\n                    <label for=\"posting-privacy-field\">\r\n                      Default visibility{' '}\r\n                      <Icon icon=\"cloud\" alt=\"Synced\" class=\"synced-icon\" />\r\n                    </label>\r\n                  </div>\r\n                  <div>\r\n                    <select\r\n                      id=\"posting-privacy-field\"\r\n                      value={prefs['posting:default:visibility'] || 'public'}\r\n                      onChange={(e) => {\r\n                        const { value } = e.target;\r\n                        (async () => {\r\n                          try {\r\n                            await masto.v1.accounts.updateCredentials({\r\n                              source: {\r\n                                privacy: value,\r\n                              },\r\n                            });\r\n                            setPrefs({\r\n                              ...prefs,\r\n                              'posting:default:visibility': value,\r\n                            });\r\n                            store.account.set('preferences', {\r\n                              ...prefs,\r\n                              'posting:default:visibility': value,\r\n                            });\r\n                          } catch (e) {\r\n                            alert('Failed to update posting privacy');\r\n                            console.error(e);\r\n                          }\r\n                        })();\r\n                      }}\r\n                    >\r\n                      <option value=\"public\">Public</option>\r\n                      <option value=\"unlisted\">Unlisted</option>\r\n                      <option value=\"private\">Followers only</option>\r\n                    </select>\r\n                  </div>\r\n                </li>\r\n              </ul>\r\n            </section>\r\n            <p class=\"section-postnote\">\r\n              <Icon icon=\"cloud\" alt=\"Synced\" class=\"synced-icon\" />{' '}\r\n              <small>\r\n                Synced to your instance server's settings.{' '}\r\n                <a\r\n                  href={`https://${instance}/`}\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                >\r\n                  Go to your instance ({instance}) for more settings.\r\n                </a>\r\n              </small>\r\n            </p>\r\n          </>\r\n        )}\r\n        <h3>Experiments</h3>\r\n        <section>\r\n          <ul>\r\n            <li>\r\n              <label>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={snapStates.settings.autoRefresh}\r\n                  onChange={(e) => {\r\n                    states.settings.autoRefresh = e.target.checked;\r\n                  }}\r\n                />{' '}\r\n                Auto refresh timeline posts\r\n              </label>\r\n            </li>\r\n            <li>\r\n              <label>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={snapStates.settings.boostsCarousel}\r\n                  onChange={(e) => {\r\n                    states.settings.boostsCarousel = e.target.checked;\r\n                  }}\r\n                />{' '}\r\n                Boosts carousel\r\n              </label>\r\n            </li>\r\n            <li>\r\n              <label>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={snapStates.settings.contentTranslation}\r\n                  onChange={(e) => {\r\n                    const { checked } = e.target;\r\n                    states.settings.contentTranslation = checked;\r\n                    if (!checked) {\r\n                      states.settings.contentTranslationTargetLanguage = null;\r\n                    }\r\n                  }}\r\n                />{' '}\r\n                Post translation\r\n              </label>\r\n              <div\r\n                class={`sub-section ${\r\n                  !snapStates.settings.contentTranslation\r\n                    ? 'more-insignificant'\r\n                    : ''\r\n                }`}\r\n              >\r\n                <div>\r\n                  <label>\r\n                    Translate to{' '}\r\n                    <select\r\n                      value={targetLanguage || ''}\r\n                      disabled={!snapStates.settings.contentTranslation}\r\n                      onChange={(e) => {\r\n                        states.settings.contentTranslationTargetLanguage =\r\n                          e.target.value || null;\r\n                      }}\r\n                    >\r\n                      <option value=\"\">\r\n                        System language ({systemTargetLanguageText})\r\n                      </option>\r\n                      <option disabled>──────────</option>\r\n                      {targetLanguages.map((lang) => (\r\n                        <option value={lang.code}>{lang.name}</option>\r\n                      ))}\r\n                    </select>\r\n                  </label>\r\n                </div>\r\n                <hr />\r\n                <p class=\"checkbox-fieldset\">\r\n                  Hide \"Translate\" button for\r\n                  {snapStates.settings.contentTranslationHideLanguages.length >\r\n                    0 && (\r\n                    <>\r\n                      {' '}\r\n                      (\r\n                      {\r\n                        snapStates.settings.contentTranslationHideLanguages\r\n                          .length\r\n                      }\r\n                      )\r\n                    </>\r\n                  )}\r\n                  :\r\n                  <div class=\"checkbox-fields\">\r\n                    {targetLanguages.map((lang) => (\r\n                      <label>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={snapStates.settings.contentTranslationHideLanguages.includes(\r\n                            lang.code,\r\n                          )}\r\n                          onChange={(e) => {\r\n                            const { checked } = e.target;\r\n                            if (checked) {\r\n                              states.settings.contentTranslationHideLanguages.push(\r\n                                lang.code,\r\n                              );\r\n                            } else {\r\n                              states.settings.contentTranslationHideLanguages =\r\n                                snapStates.settings.contentTranslationHideLanguages.filter(\r\n                                  (code) => code !== lang.code,\r\n                                );\r\n                            }\r\n                          }}\r\n                        />{' '}\r\n                        {lang.name}\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                </p>\r\n                <p class=\"insignificant\">\r\n                  <small>\r\n                    Note: This feature uses external translation services,\r\n                    powered by{' '}\r\n                    <a\r\n                      href=\"https://github.com/cheeaun/lingva-api\"\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                    >\r\n                      Lingva API\r\n                    </a>{' '}\r\n                    &amp;{' '}\r\n                    <a\r\n                      href=\"https://github.com/thedaviddelta/lingva-translate\"\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                    >\r\n                      Lingva Translate\r\n                    </a>\r\n                    .\r\n                  </small>\r\n                </p>\r\n                <hr />\r\n                <div>\r\n                  <label>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={snapStates.settings.contentTranslationAutoInline}\r\n                      disabled={!snapStates.settings.contentTranslation}\r\n                      onChange={(e) => {\r\n                        states.settings.contentTranslationAutoInline =\r\n                          e.target.checked;\r\n                      }}\r\n                    />{' '}\r\n                    Auto inline translation\r\n                  </label>\r\n                  <p class=\"insignificant\">\r\n                    <small>\r\n                      Automatically show translation for posts in timeline. Only\r\n                      works for <b>short</b> posts without content warning,\r\n                      media and poll.\r\n                    </small>\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </li>\r\n            {!!IMG_ALT_API_URL && authenticated && (\r\n              <li>\r\n                <label>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={snapStates.settings.mediaAltGenerator}\r\n                    onChange={(e) => {\r\n                      states.settings.mediaAltGenerator = e.target.checked;\r\n                    }}\r\n                  />{' '}\r\n                  Image description generator{' '}\r\n                  <Icon icon=\"sparkles2\" class=\"more-insignificant\" />\r\n                </label>\r\n                <div class=\"sub-section insignificant\">\r\n                  <small>Only for new images while composing new posts.</small>\r\n                </div>\r\n                <div class=\"sub-section insignificant\">\r\n                  <small>\r\n                    Note: This feature uses external AI service, powered by{' '}\r\n                    <a\r\n                      href=\"https://github.com/cheeaun/img-alt-api\"\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                    >\r\n                      img-alt-api\r\n                    </a>\r\n                    . May not work well. Only for images and in English.\r\n                  </small>\r\n                </div>\r\n              </li>\r\n            )}\r\n            {authenticated && (\r\n              <li>\r\n                <label>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={\r\n                      snapStates.settings.shortcutSettingsCloudImportExport\r\n                    }\r\n                    onChange={(e) => {\r\n                      states.settings.shortcutSettingsCloudImportExport =\r\n                        e.target.checked;\r\n                    }}\r\n                  />{' '}\r\n                  \"Cloud\" import/export for shortcuts settings{' '}\r\n                  <Icon icon=\"cloud\" class=\"more-insignificant\" />\r\n                </label>\r\n                <div class=\"sub-section insignificant\">\r\n                  <small>\r\n                    ⚠️⚠️⚠️ Very experimental.\r\n                    <br />\r\n                    Stored in your own profile’s notes. Profile (private) notes\r\n                    are mainly used for other profiles, and hidden for own\r\n                    profile.\r\n                  </small>\r\n                </div>\r\n                <div class=\"sub-section insignificant\">\r\n                  <small>\r\n                    Note: This feature uses currently-logged-in instance server\r\n                    API.\r\n                  </small>\r\n                </div>\r\n              </li>\r\n            )}\r\n            <li>\r\n              <label>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={snapStates.settings.cloakMode}\r\n                  onChange={(e) => {\r\n                    states.settings.cloakMode = e.target.checked;\r\n                  }}\r\n                />{' '}\r\n                Cloak mode{' '}\r\n                <span class=\"insignificant\">\r\n                  (<samp>Text</samp> → <samp>████</samp>)\r\n                </span>\r\n              </label>\r\n              <div class=\"sub-section insignificant\">\r\n                <small>\r\n                  Replace text as blocks, useful when taking screenshots, for\r\n                  privacy reasons.\r\n                </small>\r\n              </div>\r\n            </li>\r\n            {authenticated && (\r\n              <li>\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"light\"\r\n                  onClick={() => {\r\n                    states.showDrafts = true;\r\n                    states.showSettings = false;\r\n                  }}\r\n                >\r\n                  Unsent drafts\r\n                </button>\r\n              </li>\r\n            )}\r\n          </ul>\r\n        </section>\r\n        {authenticated && <PushNotificationsSection onClose={onClose} />}\r\n        <h3>About</h3>\r\n        <section>\r\n          <div\r\n            style={{\r\n              display: 'flex',\r\n              flexWrap: 'wrap',\r\n              gap: 8,\r\n              lineHeight: 1.25,\r\n              alignItems: 'center',\r\n              marginTop: 8,\r\n            }}\r\n          >\r\n            <img\r\n              src={logo}\r\n              alt=\"\"\r\n              width=\"64\"\r\n              height=\"64\"\r\n              style={{\r\n                aspectRatio: '1/1',\r\n                verticalAlign: 'middle',\r\n                background: '#b7cdf9',\r\n                borderRadius: 12,\r\n              }}\r\n            />\r\n            <div>\r\n              <b>Phanpy</b>{' '}\r\n              <a\r\n                href=\"https://hachyderm.io/@phanpy\"\r\n                // target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  states.showAccount = 'phanpy@hachyderm.io';\r\n                }}\r\n              >\r\n                @phanpy\r\n              </a>\r\n              <br />\r\n              <a\r\n                href=\"https://github.com/cheeaun/phanpy\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Built\r\n              </a>{' '}\r\n              by{' '}\r\n              <a\r\n                href=\"https://mastodon.social/@cheeaun\"\r\n                // target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  states.showAccount = 'cheeaun@mastodon.social';\r\n                }}\r\n              >\r\n                @cheeaun\r\n              </a>\r\n            </div>\r\n          </div>\r\n          <p>\r\n            <a\r\n              href=\"https://github.com/sponsors/cheeaun\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              Sponsor\r\n            </a>{' '}\r\n            &middot;{' '}\r\n            <a\r\n              href=\"https://www.buymeacoffee.com/cheeaun\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              Donate\r\n            </a>{' '}\r\n            &middot;{' '}\r\n            <a\r\n              href={PRIVACY_POLICY_URL}\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              Privacy Policy\r\n            </a>\r\n          </p>\r\n          {__BUILD_TIME__ && (\r\n            <p>\r\n              {WEBSITE && (\r\n                <>\r\n                  <span class=\"insignificant\">Site:</span>{' '}\r\n                  {WEBSITE.replace(/https?:\\/\\//g, '').replace(/\\/$/, '')}\r\n                  <br />\r\n                </>\r\n              )}\r\n              <span class=\"insignificant\">Version:</span>{' '}\r\n              <input\r\n                type=\"text\"\r\n                class=\"version-string\"\r\n                readOnly\r\n                size=\"18\" // Manually calculated here\r\n                value={`${__BUILD_TIME__.slice(0, 10).replace(/-/g, '.')}${\r\n                  __COMMIT_HASH__ ? `.${__COMMIT_HASH__}` : ''\r\n                }`}\r\n                onClick={(e) => {\r\n                  e.target.select();\r\n                  // Copy to clipboard\r\n                  try {\r\n                    navigator.clipboard.writeText(e.target.value);\r\n                    showToast('Version string copied');\r\n                  } catch (e) {\r\n                    console.warn(e);\r\n                    showToast('Unable to copy version string');\r\n                  }\r\n                }}\r\n              />{' '}\r\n              {!__FAKE_COMMIT_HASH__ && (\r\n                <span class=\"ib insignificant\">\r\n                  (\r\n                  <a\r\n                    href={`https://github.com/cheeaun/phanpy/commit/${__COMMIT_HASH__}`}\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                  >\r\n                    <RelativeTime datetime={new Date(__BUILD_TIME__)} />\r\n                  </a>\r\n                  )\r\n                </span>\r\n              )}\r\n            </p>\r\n          )}\r\n        </section>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction PushNotificationsSection({ onClose }) {\r\n  if (!isPushSupported()) return null;\r\n\r\n  const { instance } = api();\r\n  const [uiState, setUIState] = useState('default');\r\n  const pushFormRef = useRef();\r\n  const [allowNotifications, setAllowNotifications] = useState(false);\r\n  const [needRelogin, setNeedRelogin] = useState(false);\r\n  const previousPolicyRef = useRef();\r\n  useEffect(() => {\r\n    (async () => {\r\n      setUIState('loading');\r\n      try {\r\n        const { subscription, backendSubscription } = await initSubscription();\r\n        if (\r\n          backendSubscription?.policy &&\r\n          backendSubscription.policy !== 'none'\r\n        ) {\r\n          setAllowNotifications(true);\r\n          const { alerts, policy } = backendSubscription;\r\n          previousPolicyRef.current = policy;\r\n          const { elements } = pushFormRef.current;\r\n          const policyEl = elements.namedItem(policy);\r\n          if (policyEl) policyEl.value = policy;\r\n          // alerts is {}, iterate it\r\n          Object.keys(alerts).forEach((alert) => {\r\n            const el = elements.namedItem(alert);\r\n            if (el?.type === 'checkbox') {\r\n              el.checked = true;\r\n            }\r\n          });\r\n        }\r\n        setUIState('default');\r\n      } catch (err) {\r\n        console.warn(err);\r\n        if (/outside.*authorized/i.test(err.message)) {\r\n          setNeedRelogin(true);\r\n        } else {\r\n          alert(err?.message || err);\r\n        }\r\n        setUIState('error');\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  const isLoading = uiState === 'loading';\r\n\r\n  return (\r\n    <form\r\n      ref={pushFormRef}\r\n      onChange={() => {\r\n        const values = Object.fromEntries(new FormData(pushFormRef.current));\r\n        const allowNotifications = !!values['policy-allow'];\r\n        const params = {\r\n          policy: values.policy,\r\n          data: {\r\n            alerts: {\r\n              mention: !!values.mention,\r\n              favourite: !!values.favourite,\r\n              reblog: !!values.reblog,\r\n              follow: !!values.follow,\r\n              follow_request: !!values.followRequest,\r\n              poll: !!values.poll,\r\n              update: !!values.update,\r\n              status: !!values.status,\r\n            },\r\n          },\r\n        };\r\n\r\n        let alertsCount = 0;\r\n        // Remove false values from data.alerts\r\n        // API defaults to false anyway\r\n        Object.keys(params.data.alerts).forEach((key) => {\r\n          if (!params.data.alerts[key]) {\r\n            delete params.data.alerts[key];\r\n          } else {\r\n            alertsCount++;\r\n          }\r\n        });\r\n        const policyChanged = previousPolicyRef.current !== params.policy;\r\n\r\n        console.log('PN Form', {\r\n          values,\r\n          allowNotifications: allowNotifications,\r\n          params,\r\n        });\r\n\r\n        if (allowNotifications && alertsCount > 0) {\r\n          if (policyChanged) {\r\n            console.debug('Policy changed.');\r\n            removeSubscription()\r\n              .then(() => {\r\n                updateSubscription(params);\r\n              })\r\n              .catch((err) => {\r\n                console.warn(err);\r\n                alert('Failed to update subscription. Please try again.');\r\n              });\r\n          } else {\r\n            updateSubscription(params).catch((err) => {\r\n              console.warn(err);\r\n              alert('Failed to update subscription. Please try again.');\r\n            });\r\n          }\r\n        } else {\r\n          removeSubscription().catch((err) => {\r\n            console.warn(err);\r\n            alert('Failed to remove subscription. Please try again.');\r\n          });\r\n        }\r\n      }}\r\n    >\r\n      <h3>Push Notifications (beta)</h3>\r\n      <section>\r\n        <ul>\r\n          <li>\r\n            <label>\r\n              <input\r\n                type=\"checkbox\"\r\n                disabled={isLoading || needRelogin}\r\n                name=\"policy-allow\"\r\n                checked={allowNotifications}\r\n                onChange={async (e) => {\r\n                  const { checked } = e.target;\r\n                  if (checked) {\r\n                    // Request permission\r\n                    const permission = await Notification.requestPermission();\r\n                    if (permission === 'granted') {\r\n                      setAllowNotifications(true);\r\n                    } else {\r\n                      setAllowNotifications(false);\r\n                      if (permission === 'denied') {\r\n                        alert(\r\n                          'Push notifications are blocked. Please enable them in your browser settings.',\r\n                        );\r\n                      }\r\n                    }\r\n                  } else {\r\n                    setAllowNotifications(false);\r\n                  }\r\n                }}\r\n              />{' '}\r\n              Allow from{' '}\r\n              <select\r\n                name=\"policy\"\r\n                disabled={isLoading || needRelogin || !allowNotifications}\r\n              >\r\n                {[\r\n                  {\r\n                    value: 'all',\r\n                    label: 'anyone',\r\n                  },\r\n                  {\r\n                    value: 'followed',\r\n                    label: 'people I follow',\r\n                  },\r\n                  {\r\n                    value: 'follower',\r\n                    label: 'followers',\r\n                  },\r\n                ].map((type) => (\r\n                  <option value={type.value}>{type.label}</option>\r\n                ))}\r\n              </select>\r\n            </label>\r\n            <div\r\n              class=\"shazam-container no-animation\"\r\n              style={{\r\n                width: '100%',\r\n              }}\r\n              hidden={!allowNotifications}\r\n            >\r\n              <div class=\"shazam-container-inner\">\r\n                <div class=\"sub-section\">\r\n                  <ul>\r\n                    {[\r\n                      {\r\n                        value: 'mention',\r\n                        label: 'Mentions',\r\n                      },\r\n                      {\r\n                        value: 'favourite',\r\n                        label: 'Likes',\r\n                      },\r\n                      {\r\n                        value: 'reblog',\r\n                        label: 'Boosts',\r\n                      },\r\n                      {\r\n                        value: 'follow',\r\n                        label: 'Follows',\r\n                      },\r\n                      {\r\n                        value: 'followRequest',\r\n                        label: 'Follow requests',\r\n                      },\r\n                      {\r\n                        value: 'poll',\r\n                        label: 'Polls',\r\n                      },\r\n                      {\r\n                        value: 'update',\r\n                        label: 'Post edits',\r\n                      },\r\n                      {\r\n                        value: 'status',\r\n                        label: 'New posts',\r\n                      },\r\n                    ].map((alert) => (\r\n                      <li>\r\n                        <label>\r\n                          <input type=\"checkbox\" name={alert.value} />{' '}\r\n                          {alert.label}\r\n                        </label>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {needRelogin && (\r\n              <div class=\"sub-section\">\r\n                <p>\r\n                  Push permission was not granted since your last login. You'll\r\n                  need to{' '}\r\n                  <Link to={`/login?instance=${instance}`} onClick={onClose}>\r\n                    <b>log in</b> again to grant push permission\r\n                  </Link>\r\n                  .\r\n                </p>\r\n              </div>\r\n            )}\r\n          </li>\r\n        </ul>\r\n      </section>\r\n      <p class=\"section-postnote\">\r\n        <small>\r\n          NOTE: Push notifications only work for <b>one account</b>.\r\n        </small>\r\n      </p>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default Settings;\r\n","import { useEffect, useRef } from 'preact/hooks';\r\nimport { useLocation } from 'react-router-dom';\r\n\r\n// Hook that runs a callback when the location changes\r\n// Won't run on the first render\r\n\r\nexport default function useLocationChange(fn) {\r\n  if (!fn) return;\r\n  const location = useLocation();\r\n  const currentLocationRef = useRef(location.pathname);\r\n  useEffect(() => {\r\n    // console.log('location', {\r\n    //   current: currentLocationRef.current,\r\n    //   next: location.pathname,\r\n    // });\r\n    if (\r\n      currentLocationRef.current &&\r\n      location.pathname !== currentLocationRef.current\r\n    ) {\r\n      fn?.();\r\n    }\r\n  }, [location.pathname, fn]);\r\n}\r\n","import { useEffect } from 'preact/hooks';\r\n\r\nimport { api } from '../utils/api';\r\nimport states from '../utils/states';\r\nimport useLocationChange from '../utils/useLocationChange';\r\n\r\nimport AccountInfo from './account-info';\r\nimport Icon from './icon';\r\n\r\nfunction AccountSheet({ account, instance: propInstance, onClose }) {\r\n  const { masto, instance, authenticated } = api({ instance: propInstance });\r\n  const isString = typeof account === 'string';\r\n\r\n  useEffect(() => {\r\n    if (!isString) {\r\n      states.accounts[`${account.id}@${instance}`] = account;\r\n    }\r\n  }, [account]);\r\n\r\n  useLocationChange(onClose);\r\n\r\n  return (\r\n    <div\r\n      class=\"sheet\"\r\n      // onClick={(e) => {\r\n      //   const accountBlock = e.target.closest('.account-block');\r\n      //   if (accountBlock) {\r\n      //     onClose({\r\n      //       destination: 'account-statuses',\r\n      //     });\r\n      //   }\r\n      // }}\r\n    >\r\n      {!!onClose && (\r\n        <button type=\"button\" class=\"sheet-close outer\" onClick={onClose}>\r\n          <Icon icon=\"x\" />\r\n        </button>\r\n      )}\r\n      <AccountInfo\r\n        instance={instance}\r\n        authenticated={authenticated}\r\n        account={account}\r\n        fetchAccount={async () => {\r\n          if (isString) {\r\n            try {\r\n              const info = await masto.v1.accounts.lookup({\r\n                acct: account,\r\n                skip_webfinger: false,\r\n              });\r\n              return info;\r\n            } catch (e) {\r\n              const result = await masto.v2.search.fetch({\r\n                q: account,\r\n                type: 'accounts',\r\n                limit: 1,\r\n                resolve: authenticated,\r\n              });\r\n              if (result.accounts.length) {\r\n                return result.accounts[0];\r\n              } else if (/https?:\\/\\/[^/]+\\/@/.test(account)) {\r\n                const accountURL = new URL(account);\r\n                const { hostname, pathname } = accountURL;\r\n                const acct =\r\n                  pathname.replace(/^\\//, '').replace(/\\/$/, '') +\r\n                  '@' +\r\n                  hostname;\r\n                const result = await masto.v2.search.fetch({\r\n                  q: acct,\r\n                  type: 'accounts',\r\n                  limit: 1,\r\n                  resolve: authenticated,\r\n                });\r\n                if (result.accounts.length) {\r\n                  return result.accounts[0];\r\n                }\r\n              }\r\n            }\r\n          } else {\r\n            return account;\r\n          }\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AccountSheet;\r\n","import './drafts.css';\r\n\r\nimport { useEffect, useMemo, useReducer, useState } from 'react';\r\n\r\nimport { api } from '../utils/api';\r\nimport db from '../utils/db';\r\nimport niceDateTime from '../utils/nice-date-time';\r\nimport states from '../utils/states';\r\nimport { getCurrentAccountNS } from '../utils/store-utils';\r\n\r\nimport Icon from './icon';\r\nimport Loader from './loader';\r\nimport MenuConfirm from './menu-confirm';\r\n\r\nfunction Drafts({ onClose }) {\r\n  const { masto } = api();\r\n  const [uiState, setUIState] = useState('default');\r\n  const [drafts, setDrafts] = useState([]);\r\n  const [reloadCount, reload] = useReducer((c) => c + 1, 0);\r\n\r\n  useEffect(() => {\r\n    setUIState('loading');\r\n    (async () => {\r\n      try {\r\n        const keys = await db.drafts.keys();\r\n        if (keys.length) {\r\n          const ns = getCurrentAccountNS();\r\n          const ownKeys = keys.filter((key) => key.startsWith(ns));\r\n          if (ownKeys.length) {\r\n            const drafts = await db.drafts.getMany(ownKeys);\r\n            drafts.sort(\r\n              (a, b) =>\r\n                new Date(b.updatedAt).getTime() -\r\n                new Date(a.updatedAt).getTime(),\r\n            );\r\n            setDrafts(drafts);\r\n          } else {\r\n            setDrafts([]);\r\n          }\r\n        } else {\r\n          setDrafts([]);\r\n        }\r\n        setUIState('default');\r\n      } catch (e) {\r\n        console.error(e);\r\n        setUIState('error');\r\n      }\r\n    })();\r\n  }, [reloadCount]);\r\n\r\n  const hasDrafts = drafts?.length > 0;\r\n\r\n  return (\r\n    <div class=\"sheet\">\r\n      {!!onClose && (\r\n        <button type=\"button\" class=\"sheet-close\" onClick={onClose}>\r\n          <Icon icon=\"x\" />\r\n        </button>\r\n      )}\r\n      <header>\r\n        <h2>\r\n          Unsent drafts <Loader abrupt hidden={uiState !== 'loading'} />\r\n        </h2>\r\n        {hasDrafts && (\r\n          <div class=\"insignificant\">\r\n            Looks like you have unsent drafts. Let's continue where you left\r\n            off.\r\n          </div>\r\n        )}\r\n      </header>\r\n      <main>\r\n        {hasDrafts ? (\r\n          <>\r\n            <ul class=\"drafts-list\">\r\n              {drafts.map((draft) => {\r\n                const { updatedAt, key, draftStatus, replyTo } = draft;\r\n                const updatedAtDate = new Date(updatedAt);\r\n                return (\r\n                  <li key={updatedAt}>\r\n                    <div class=\"mini-draft-meta\">\r\n                      <b>\r\n                        <Icon icon={replyTo ? 'reply' : 'quill'} size=\"s\" />{' '}\r\n                        <time>\r\n                          {!!replyTo && (\r\n                            <>\r\n                              @{replyTo.account.acct}\r\n                              <br />\r\n                            </>\r\n                          )}\r\n                          {niceDateTime(updatedAtDate)}\r\n                        </time>\r\n                      </b>\r\n                      <MenuConfirm\r\n                        confirmLabel={<span>Delete this draft?</span>}\r\n                        menuItemClassName=\"danger\"\r\n                        align=\"end\"\r\n                        disabled={uiState === 'loading'}\r\n                        onClick={() => {\r\n                          (async () => {\r\n                            try {\r\n                              // const yes = confirm('Delete this draft?');\r\n                              // if (yes) {\r\n                              await db.drafts.del(key);\r\n                              reload();\r\n                              // }\r\n                            } catch (e) {\r\n                              alert('Error deleting draft! Please try again.');\r\n                            }\r\n                          })();\r\n                        }}\r\n                      >\r\n                        <button\r\n                          type=\"button\"\r\n                          class=\"small light\"\r\n                          disabled={uiState === 'loading'}\r\n                        >\r\n                          Delete&hellip;\r\n                        </button>\r\n                      </MenuConfirm>\r\n                    </div>\r\n                    <button\r\n                      type=\"button\"\r\n                      disabled={uiState === 'loading'}\r\n                      class=\"draft-item\"\r\n                      onClick={async () => {\r\n                        // console.log({ draftStatus });\r\n                        let replyToStatus;\r\n                        if (replyTo) {\r\n                          setUIState('loading');\r\n                          try {\r\n                            replyToStatus = await masto.v1.statuses\r\n                              .$select(replyTo.id)\r\n                              .fetch();\r\n                          } catch (e) {\r\n                            console.error(e);\r\n                            alert('Error fetching reply-to status!');\r\n                            setUIState('default');\r\n                            return;\r\n                          }\r\n                          setUIState('default');\r\n                        }\r\n                        window.__COMPOSE__ = {\r\n                          draftStatus,\r\n                          replyToStatus,\r\n                        };\r\n                        states.showCompose = true;\r\n                        states.showDrafts = false;\r\n                      }}\r\n                    >\r\n                      <MiniDraft draft={draft} />\r\n                    </button>\r\n                  </li>\r\n                );\r\n              })}\r\n            </ul>\r\n            {drafts.length > 1 && (\r\n              <p>\r\n                <MenuConfirm\r\n                  confirmLabel={<span>Delete all drafts?</span>}\r\n                  menuItemClassName=\"danger\"\r\n                  disabled={uiState === 'loading'}\r\n                  onClick={() => {\r\n                    (async () => {\r\n                      // const yes = confirm('Delete all drafts?');\r\n                      // if (yes) {\r\n                      setUIState('loading');\r\n                      try {\r\n                        await db.drafts.delMany(\r\n                          drafts.map((draft) => draft.key),\r\n                        );\r\n                        setUIState('default');\r\n                        reload();\r\n                      } catch (e) {\r\n                        console.error(e);\r\n                        alert('Error deleting drafts! Please try again.');\r\n                        setUIState('error');\r\n                      }\r\n                      // }\r\n                    })();\r\n                  }}\r\n                >\r\n                  <button\r\n                    type=\"button\"\r\n                    class=\"light danger\"\r\n                    disabled={uiState === 'loading'}\r\n                  >\r\n                    Delete all&hellip;\r\n                  </button>\r\n                </MenuConfirm>\r\n              </p>\r\n            )}\r\n          </>\r\n        ) : (\r\n          <p>No drafts found.</p>\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction MiniDraft({ draft }) {\r\n  const { draftStatus, replyTo } = draft;\r\n  const { status, spoilerText, poll, mediaAttachments } = draftStatus;\r\n  const hasPoll = poll?.options?.length > 0;\r\n  const hasMedia = mediaAttachments?.length > 0;\r\n  const hasPollOrMedia = hasPoll || hasMedia;\r\n  const firstImageMedia = useMemo(() => {\r\n    if (!hasMedia) return;\r\n    const image = mediaAttachments.find((media) => /image/.test(media.type));\r\n    if (!image) return;\r\n    const { file } = image;\r\n    const objectURL = URL.createObjectURL(file);\r\n    return objectURL;\r\n  }, [hasMedia, mediaAttachments]);\r\n  return (\r\n    <>\r\n      <div class=\"mini-draft\">\r\n        {hasPollOrMedia && (\r\n          <div\r\n            class={`mini-draft-aside ${firstImageMedia ? 'has-image' : ''}`}\r\n            style={\r\n              firstImageMedia\r\n                ? {\r\n                    '--bg-image': `url(${firstImageMedia})`,\r\n                  }\r\n                : {}\r\n            }\r\n          >\r\n            {hasPoll && <Icon icon=\"poll\" />}\r\n            {hasMedia && (\r\n              <span>\r\n                <Icon icon=\"attachment\" />{' '}\r\n                <small>{mediaAttachments?.length}</small>\r\n              </span>\r\n            )}\r\n          </div>\r\n        )}\r\n        <div class=\"mini-draft-main\">\r\n          {!!spoilerText && <div class=\"mini-draft-spoiler\">{spoilerText}</div>}\r\n          {!!status && <div class=\"mini-draft-status\">{status}</div>}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Drafts;\r\n","import './embed-modal.css';\r\n\r\nimport Icon from './icon';\r\n\r\nfunction EmbedModal({ html, url, width, height, onClose = () => {} }) {\r\n  return (\r\n    <div class=\"embed-modal-container\">\r\n      <div class=\"top-controls\">\r\n        <button type=\"button\" class=\"light\" onClick={() => onClose()}>\r\n          <Icon icon=\"x\" />\r\n        </button>\r\n        {url && (\r\n          <a\r\n            href={url}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            class=\"button plain\"\r\n          >\r\n            <span>Open link</span> <Icon icon=\"external\" />\r\n          </a>\r\n        )}\r\n      </div>\r\n      <div\r\n        class=\"embed-content\"\r\n        dangerouslySetInnerHTML={{ __html: html }}\r\n        style={{\r\n          '--width': width + 'px',\r\n          '--height': height + 'px',\r\n          '--aspect-ratio': `${width}/${height}`,\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EmbedModal;\r\n","import './generic-accounts.css';\r\n\r\nimport { useEffect, useRef, useState } from 'preact/hooks';\r\nimport { InView } from 'react-intersection-observer';\r\nimport { useSnapshot } from 'valtio';\r\n\r\nimport { api } from '../utils/api';\r\nimport { fetchRelationships } from '../utils/relationships';\r\nimport states from '../utils/states';\r\nimport useLocationChange from '../utils/useLocationChange';\r\n\r\nimport AccountBlock from './account-block';\r\nimport Icon from './icon';\r\nimport Loader from './loader';\r\n\r\nexport default function GenericAccounts({\r\n  instance,\r\n  excludeRelationshipAttrs = [],\r\n  onClose = () => {},\r\n}) {\r\n  const { masto, instance: currentInstance } = api();\r\n  const isCurrentInstance = instance ? instance === currentInstance : true;\r\n  const snapStates = useSnapshot(states);\r\n  ``;\r\n  const [uiState, setUIState] = useState('default');\r\n  const [accounts, setAccounts] = useState([]);\r\n  const [showMore, setShowMore] = useState(false);\r\n\r\n  useLocationChange(onClose);\r\n\r\n  if (!snapStates.showGenericAccounts) {\r\n    return null;\r\n  }\r\n\r\n  const {\r\n    id,\r\n    heading,\r\n    fetchAccounts,\r\n    accounts: staticAccounts,\r\n    showReactions,\r\n  } = snapStates.showGenericAccounts;\r\n\r\n  const [relationshipsMap, setRelationshipsMap] = useState({});\r\n\r\n  const loadRelationships = async (accounts) => {\r\n    if (!accounts?.length) return;\r\n    if (!isCurrentInstance) return;\r\n    const relationships = await fetchRelationships(accounts, relationshipsMap);\r\n    if (relationships) {\r\n      setRelationshipsMap({\r\n        ...relationshipsMap,\r\n        ...relationships,\r\n      });\r\n    }\r\n  };\r\n\r\n  const loadAccounts = (firstLoad) => {\r\n    if (!fetchAccounts) return;\r\n    if (firstLoad) setAccounts([]);\r\n    setUIState('loading');\r\n    (async () => {\r\n      try {\r\n        const { done, value } = await fetchAccounts(firstLoad);\r\n        if (Array.isArray(value)) {\r\n          if (firstLoad) {\r\n            const accounts = [];\r\n            for (let i = 0; i < value.length; i++) {\r\n              const account = value[i];\r\n              const theAccount = accounts.find(\r\n                (a, j) => a.id === account.id && i !== j,\r\n              );\r\n              if (!theAccount) {\r\n                accounts.push({\r\n                  _types: [],\r\n                  ...account,\r\n                });\r\n              } else {\r\n                theAccount._types.push(...account._types);\r\n              }\r\n            }\r\n            setAccounts(accounts);\r\n          } else {\r\n            // setAccounts((prev) => [...prev, ...value]);\r\n            // Merge accounts by id and _types\r\n            setAccounts((prev) => {\r\n              const newAccounts = prev;\r\n              for (const account of value) {\r\n                const theAccount = newAccounts.find((a) => a.id === account.id);\r\n                if (!theAccount) {\r\n                  newAccounts.push(account);\r\n                } else {\r\n                  theAccount._types.push(...account._types);\r\n                }\r\n              }\r\n              return newAccounts;\r\n            });\r\n          }\r\n          setShowMore(!done);\r\n\r\n          loadRelationships(value);\r\n        } else {\r\n          setShowMore(false);\r\n        }\r\n        setUIState('default');\r\n      } catch (e) {\r\n        console.error(e);\r\n        setUIState('error');\r\n      }\r\n    })();\r\n  };\r\n\r\n  const firstLoad = useRef(true);\r\n  useEffect(() => {\r\n    if (staticAccounts?.length > 0) {\r\n      setAccounts(staticAccounts);\r\n      loadRelationships(staticAccounts);\r\n    } else {\r\n      loadAccounts(true);\r\n      firstLoad.current = false;\r\n    }\r\n  }, [staticAccounts, fetchAccounts]);\r\n\r\n  useEffect(() => {\r\n    if (firstLoad.current) return;\r\n    // reloadGenericAccounts contains value like {id: 'mute', counter: 1}\r\n    // We only need to reload if the id matches\r\n    if (snapStates.reloadGenericAccounts?.id === id) {\r\n      loadAccounts(true);\r\n    }\r\n  }, [snapStates.reloadGenericAccounts.counter]);\r\n\r\n  return (\r\n    <div id=\"generic-accounts-container\" class=\"sheet\" tabindex=\"-1\">\r\n      <button type=\"button\" class=\"sheet-close\" onClick={onClose}>\r\n        <Icon icon=\"x\" />\r\n      </button>\r\n      <header>\r\n        <h2>{heading || 'Accounts'}</h2>\r\n      </header>\r\n      <main>\r\n        {accounts.length > 0 ? (\r\n          <>\r\n            <ul class=\"accounts-list\">\r\n              {accounts.map((account) => {\r\n                const relationship = relationshipsMap[account.id];\r\n                const key = `${account.id}-${account._types?.length || ''}`;\r\n                return (\r\n                  <li key={key}>\r\n                    {showReactions && account._types?.length > 0 && (\r\n                      <div class=\"reactions-block\">\r\n                        {account._types.map((type) => (\r\n                          <Icon\r\n                            icon={\r\n                              {\r\n                                reblog: 'rocket',\r\n                                favourite: 'heart',\r\n                              }[type]\r\n                            }\r\n                            class={`${type}-icon`}\r\n                          />\r\n                        ))}\r\n                      </div>\r\n                    )}\r\n                    <div class=\"account-relationships\">\r\n                      <AccountBlock\r\n                        account={account}\r\n                        showStats\r\n                        relationship={relationship}\r\n                        excludeRelationshipAttrs={excludeRelationshipAttrs}\r\n                      />\r\n                    </div>\r\n                  </li>\r\n                );\r\n              })}\r\n            </ul>\r\n            {uiState === 'default' ? (\r\n              showMore ? (\r\n                <InView\r\n                  onChange={(inView) => {\r\n                    if (inView) {\r\n                      loadAccounts();\r\n                    }\r\n                  }}\r\n                >\r\n                  <button\r\n                    type=\"button\"\r\n                    class=\"plain block\"\r\n                    onClick={() => loadAccounts()}\r\n                  >\r\n                    Show more&hellip;\r\n                  </button>\r\n                </InView>\r\n              ) : (\r\n                <p class=\"ui-state insignificant\">The end.</p>\r\n              )\r\n            ) : (\r\n              uiState === 'loading' && (\r\n                <p class=\"ui-state\">\r\n                  <Loader abrupt />\r\n                </p>\r\n              )\r\n            )}\r\n          </>\r\n        ) : uiState === 'loading' ? (\r\n          <p class=\"ui-state\">\r\n            <Loader abrupt />\r\n          </p>\r\n        ) : uiState === 'error' ? (\r\n          <p class=\"ui-state\">Error loading accounts</p>\r\n        ) : (\r\n          <p class=\"ui-state insignificant\">Nothing to show</p>\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import { Menu, MenuItem } from '@szhsin/react-menu';\r\nimport { useState } from 'preact/hooks';\r\nimport { useSnapshot } from 'valtio';\r\n\r\nimport getTranslateTargetLanguage from '../utils/get-translate-target-language';\r\nimport localeMatch from '../utils/locale-match';\r\nimport { speak, supportsTTS } from '../utils/speech';\r\nimport states from '../utils/states';\r\n\r\nimport Icon from './icon';\r\nimport Menu2 from './menu2';\r\nimport TranslationBlock from './translation-block';\r\n\r\nexport default function MediaAltModal({ alt, lang, onClose }) {\r\n  const snapStates = useSnapshot(states);\r\n  const [forceTranslate, setForceTranslate] = useState(false);\r\n  const targetLanguage = getTranslateTargetLanguage(true);\r\n  const contentTranslationHideLanguages =\r\n    snapStates.settings.contentTranslationHideLanguages || [];\r\n  const differentLanguage =\r\n    !!lang &&\r\n    lang !== targetLanguage &&\r\n    !localeMatch([lang], [targetLanguage]) &&\r\n    !contentTranslationHideLanguages.find(\r\n      (l) => lang === l || localeMatch([lang], [l]),\r\n    );\r\n\r\n  return (\r\n    <div class=\"sheet\" tabindex=\"-1\">\r\n      {!!onClose && (\r\n        <button type=\"button\" class=\"sheet-close outer\" onClick={onClose}>\r\n          <Icon icon=\"x\" />\r\n        </button>\r\n      )}\r\n      <header class=\"header-grid\">\r\n        <h2>Media description</h2>\r\n        <div class=\"header-side\">\r\n          <Menu2\r\n            align=\"end\"\r\n            menuButton={\r\n              <button type=\"button\" class=\"plain4\">\r\n                <Icon icon=\"more\" alt=\"More\" size=\"xl\" />\r\n              </button>\r\n            }\r\n          >\r\n            <MenuItem\r\n              disabled={forceTranslate}\r\n              onClick={() => {\r\n                setForceTranslate(true);\r\n              }}\r\n            >\r\n              <Icon icon=\"translate\" />\r\n              <span>Translate</span>\r\n            </MenuItem>\r\n            {supportsTTS && (\r\n              <MenuItem\r\n                onClick={() => {\r\n                  speak(alt, lang);\r\n                }}\r\n              >\r\n                <Icon icon=\"speak\" />\r\n                <span>Speak</span>\r\n              </MenuItem>\r\n            )}\r\n          </Menu2>\r\n        </div>\r\n      </header>\r\n      <main lang={lang} dir=\"auto\">\r\n        <p\r\n          style={{\r\n            whiteSpace: 'pre-wrap',\r\n            textWrap: 'pretty',\r\n          }}\r\n        >\r\n          {alt}\r\n        </p>\r\n        {(differentLanguage || forceTranslate) && (\r\n          <TranslationBlock\r\n            forceTranslate={forceTranslate}\r\n            sourceLanguage={lang}\r\n            text={alt}\r\n          />\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","import './report-modal.css';\r\n\r\nimport { Fragment } from 'preact';\r\nimport { useMemo, useRef, useState } from 'preact/hooks';\r\n\r\nimport { api } from '../utils/api';\r\nimport showToast from '../utils/show-toast';\r\nimport { getCurrentInstance } from '../utils/store-utils';\r\n\r\nimport AccountBlock from './account-block';\r\nimport Icon from './icon';\r\nimport Loader from './loader';\r\nimport Status from './status';\r\n\r\n// NOTE: `dislike` hidden for now, it's actually not used for reporting\r\n// Mastodon shows another screen for unfollowing, muting or blocking instead of reporting\r\n\r\nconst CATEGORIES = [, /*'dislike'*/ 'spam', 'legal', 'violation', 'other'];\r\n// `violation` will be set if there are `rule_ids[]`\r\n\r\nconst CATEGORIES_INFO = {\r\n  // dislike: {\r\n  //   label: 'Dislike',\r\n  //   description: 'Not something you want to see',\r\n  // },\r\n  spam: {\r\n    label: 'Spam',\r\n    description: 'Malicious links, fake engagement, or repetitive replies',\r\n  },\r\n  legal: {\r\n    label: 'Illegal',\r\n    description: \"Violates the law of your or the server's country\",\r\n  },\r\n  violation: {\r\n    label: 'Server rule violation',\r\n    description: 'Breaks specific server rules',\r\n    stampLabel: 'Violation',\r\n  },\r\n  other: {\r\n    label: 'Other',\r\n    description: \"Issue doesn't fit other categories\",\r\n    excludeStamp: true,\r\n  },\r\n};\r\n\r\nfunction ReportModal({ account, post, onClose }) {\r\n  const { masto } = api();\r\n  const [uiState, setUIState] = useState('default');\r\n  const [username, domain] = account.acct.split('@');\r\n\r\n  const [rules, currentDomain] = useMemo(() => {\r\n    const { rules, domain } = getCurrentInstance();\r\n    return [rules || [], domain];\r\n  });\r\n\r\n  const [selectedCategory, setSelectedCategory] = useState(null);\r\n  const [showRules, setShowRules] = useState(false);\r\n\r\n  const rulesRef = useRef(null);\r\n  const [hasRules, setHasRules] = useState(false);\r\n\r\n  return (\r\n    <div class=\"report-modal-container\">\r\n      <div class=\"top-controls\">\r\n        <h1>{post ? 'Report Post' : `Report @${username}`}</h1>\r\n        <button\r\n          type=\"button\"\r\n          class=\"plain4 small\"\r\n          disabled={uiState === 'loading'}\r\n          onClick={() => onClose()}\r\n        >\r\n          <Icon icon=\"x\" size=\"xl\" />\r\n        </button>\r\n      </div>\r\n      <main>\r\n        <div class=\"report-preview\">\r\n          {post ? (\r\n            <Status status={post} size=\"s\" previewMode />\r\n          ) : (\r\n            <AccountBlock\r\n              account={account}\r\n              avatarSize=\"xxl\"\r\n              useAvatarStatic\r\n              showStats\r\n              showActivity\r\n            />\r\n          )}\r\n        </div>\r\n        {!!selectedCategory &&\r\n          !CATEGORIES_INFO[selectedCategory].excludeStamp && (\r\n            <span\r\n              class=\"rubber-stamp\"\r\n              key={selectedCategory}\r\n              aria-hidden=\"true\"\r\n            >\r\n              {CATEGORIES_INFO[selectedCategory].stampLabel ||\r\n                CATEGORIES_INFO[selectedCategory].label}\r\n              <small>Pending review</small>\r\n            </span>\r\n          )}\r\n        <form\r\n          onSubmit={(e) => {\r\n            e.preventDefault();\r\n\r\n            const formData = new FormData(e.target);\r\n            const entries = Object.fromEntries(formData.entries());\r\n            console.log('ENTRIES', entries);\r\n\r\n            let { category, comment, forward } = entries;\r\n            if (!comment) comment = undefined;\r\n            if (forward === 'on') forward = true;\r\n            const ruleIds =\r\n              category === 'violation'\r\n                ? Object.entries(entries)\r\n                    .filter(([key]) => key.startsWith('rule_ids'))\r\n                    .map(([key, value]) => value)\r\n                : undefined;\r\n\r\n            const params = {\r\n              category,\r\n              comment,\r\n              forward,\r\n              ruleIds,\r\n            };\r\n            console.log('PARAMS', params);\r\n\r\n            setUIState('loading');\r\n            (async () => {\r\n              try {\r\n                await masto.v1.reports.create({\r\n                  accountId: account.id,\r\n                  statusIds: post?.id ? [post.id] : undefined,\r\n                  category,\r\n                  comment,\r\n                  ruleIds,\r\n                  forward,\r\n                });\r\n                setUIState('success');\r\n                showToast(post ? 'Post reported' : 'Profile reported');\r\n                onClose();\r\n              } catch (error) {\r\n                console.error(error);\r\n                setUIState('error');\r\n                showToast(\r\n                  error?.message ||\r\n                    (post\r\n                      ? 'Unable to report post'\r\n                      : 'Unable to report profile'),\r\n                );\r\n              }\r\n            })();\r\n          }}\r\n        >\r\n          <p>\r\n            {post\r\n              ? `What's the issue with this post?`\r\n              : `What's the issue with this profile?`}\r\n          </p>\r\n          <section class=\"report-categories\">\r\n            {CATEGORIES.map((category) =>\r\n              category === 'violation' && !rules?.length ? null : (\r\n                <Fragment key={category}>\r\n                  <label class=\"report-category\">\r\n                    <input\r\n                      type=\"radio\"\r\n                      name=\"category\"\r\n                      value={category}\r\n                      required\r\n                      disabled={uiState === 'loading'}\r\n                      onChange={(e) => {\r\n                        setSelectedCategory(e.target.value);\r\n                        setShowRules(e.target.value === 'violation');\r\n                      }}\r\n                    />\r\n                    <span>\r\n                      {CATEGORIES_INFO[category].label} &nbsp;\r\n                      <small class=\"ib insignificant\">\r\n                        {CATEGORIES_INFO[category].description}\r\n                      </small>\r\n                    </span>\r\n                  </label>\r\n                  {category === 'violation' && !!rules?.length && (\r\n                    <div\r\n                      class=\"shazam-container no-animation\"\r\n                      hidden={!showRules}\r\n                    >\r\n                      <div class=\"shazam-container-inner\">\r\n                        <div class=\"report-rules\" ref={rulesRef}>\r\n                          {rules.map((rule, i) => (\r\n                            <label class=\"report-rule\" key={rule.id}>\r\n                              <input\r\n                                type=\"checkbox\"\r\n                                name={`rule_ids[${i}]`}\r\n                                value={rule.id}\r\n                                required={showRules && !hasRules}\r\n                                disabled={uiState === 'loading'}\r\n                                onChange={(e) => {\r\n                                  const { checked } = e.target;\r\n                                  if (checked) {\r\n                                    setHasRules(true);\r\n                                  } else {\r\n                                    const checkedInputs =\r\n                                      rulesRef.current.querySelectorAll(\r\n                                        'input:checked',\r\n                                      );\r\n                                    if (!checkedInputs.length) {\r\n                                      setHasRules(false);\r\n                                    }\r\n                                  }\r\n                                }}\r\n                              />\r\n                              <span>{rule.text}</span>\r\n                            </label>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </Fragment>\r\n              ),\r\n            )}\r\n          </section>\r\n          <section class=\"report-comment\">\r\n            <p>\r\n              <label for=\"report-comment\">Additional info</label>\r\n            </p>\r\n            <textarea\r\n              maxlength=\"1000\"\r\n              rows=\"1\"\r\n              name=\"comment\"\r\n              id=\"report-comment\"\r\n              disabled={uiState === 'loading'}\r\n            />\r\n          </section>\r\n          {!!domain && domain !== currentDomain && (\r\n            <section>\r\n              <p>\r\n                <label>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    switch\r\n                    name=\"forward\"\r\n                    disabled={uiState === 'loading'}\r\n                  />{' '}\r\n                  <span>\r\n                    Forward to <i>{domain}</i>\r\n                  </span>\r\n                </label>\r\n              </p>\r\n            </section>\r\n          )}\r\n          <footer>\r\n            <button type=\"submit\" disabled={uiState === 'loading'}>\r\n              Send Report\r\n            </button>{' '}\r\n            <button\r\n              type=\"submit\"\r\n              class=\"plain2\"\r\n              disabled={uiState === 'loading'}\r\n              onClick={async () => {\r\n                try {\r\n                  await masto.v1.accounts.$select(account.id).mute(); // Infinite duration\r\n                  showToast(`Muted ${username}`);\r\n                } catch (e) {\r\n                  console.error(e);\r\n                  showToast(`Unable to mute ${username}`);\r\n                }\r\n                // onSubmit will still run\r\n              }}\r\n            >\r\n              Send Report <small class=\"ib\">+ Mute profile</small>\r\n            </button>{' '}\r\n            <button\r\n              type=\"submit\"\r\n              class=\"plain2\"\r\n              disabled={uiState === 'loading'}\r\n              onClick={async () => {\r\n                try {\r\n                  await masto.v1.accounts.$select(account.id).block();\r\n                  showToast(`Blocked ${username}`);\r\n                } catch (e) {\r\n                  console.error(e);\r\n                  showToast(`Unable to block ${username}`);\r\n                }\r\n                // onSubmit will still run\r\n              }}\r\n            >\r\n              Send Report <small class=\"ib\">+ Block profile</small>\r\n            </button>\r\n            <Loader hidden={uiState !== 'loading'} />\r\n          </footer>\r\n        </form>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ReportModal;\r\n","import { useLocation, useNavigate } from 'react-router-dom';\r\nimport { subscribe, useSnapshot } from 'valtio';\r\n\r\nimport Accounts from '../pages/accounts';\r\nimport Settings from '../pages/settings';\r\nimport focusDeck from '../utils/focus-deck';\r\nimport showToast from '../utils/show-toast';\r\nimport states from '../utils/states';\r\n\r\nimport AccountSheet from './account-sheet';\r\nimport Compose from './compose';\r\nimport Drafts from './drafts';\r\nimport EmbedModal from './embed-modal';\r\nimport GenericAccounts from './generic-accounts';\r\nimport MediaAltModal from './media-alt-modal';\r\nimport MediaModal from './media-modal';\r\nimport Modal from './modal';\r\nimport ReportModal from './report-modal';\r\nimport ShortcutsSettings from './shortcuts-settings';\r\n\r\nsubscribe(states, (changes) => {\r\n  for (const [action, path, value, prevValue] of changes) {\r\n    // When closing modal, focus on deck\r\n    if (/^show/i.test(path) && !value) {\r\n      focusDeck();\r\n    }\r\n  }\r\n});\r\n\r\nexport default function Modals() {\r\n  const snapStates = useSnapshot(states);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  return (\r\n    <>\r\n      {!!snapStates.showCompose && (\r\n        <Modal class=\"solid\">\r\n          <Compose\r\n            replyToStatus={\r\n              typeof snapStates.showCompose !== 'boolean'\r\n                ? snapStates.showCompose.replyToStatus\r\n                : window.__COMPOSE__?.replyToStatus || null\r\n            }\r\n            editStatus={\r\n              states.showCompose?.editStatus ||\r\n              window.__COMPOSE__?.editStatus ||\r\n              null\r\n            }\r\n            draftStatus={\r\n              states.showCompose?.draftStatus ||\r\n              window.__COMPOSE__?.draftStatus ||\r\n              null\r\n            }\r\n            onClose={(results) => {\r\n              const { newStatus, instance, type } = results || {};\r\n              states.showCompose = false;\r\n              window.__COMPOSE__ = null;\r\n              if (newStatus) {\r\n                states.reloadStatusPage++;\r\n                showToast({\r\n                  text: {\r\n                    post: 'Post published. Check it out.',\r\n                    reply: 'Reply posted. Check it out.',\r\n                    edit: 'Post updated. Check it out.',\r\n                  }[type || 'post'],\r\n                  delay: 1000,\r\n                  duration: 10_000, // 10 seconds\r\n                  onClick: (toast) => {\r\n                    toast.hideToast();\r\n                    states.prevLocation = location;\r\n                    navigate(\r\n                      instance\r\n                        ? `/${instance}/s/${newStatus.id}`\r\n                        : `/s/${newStatus.id}`,\r\n                    );\r\n                  },\r\n                });\r\n              }\r\n            }}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showSettings && (\r\n        <Modal\r\n          onClose={() => {\r\n            states.showSettings = false;\r\n          }}\r\n        >\r\n          <Settings\r\n            onClose={() => {\r\n              states.showSettings = false;\r\n            }}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showAccounts && (\r\n        <Modal\r\n          onClose={() => {\r\n            states.showAccounts = false;\r\n          }}\r\n        >\r\n          <Accounts\r\n            onClose={() => {\r\n              states.showAccounts = false;\r\n            }}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showAccount && (\r\n        <Modal\r\n          onClose={() => {\r\n            states.showAccount = false;\r\n          }}\r\n        >\r\n          <AccountSheet\r\n            account={snapStates.showAccount?.account || snapStates.showAccount}\r\n            instance={snapStates.showAccount?.instance}\r\n            onClose={({ destination } = {}) => {\r\n              states.showAccount = false;\r\n              // states.showGenericAccounts = false;\r\n              // if (destination) {\r\n              //   states.showAccounts = false;\r\n              // }\r\n            }}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showDrafts && (\r\n        <Modal\r\n          onClose={() => {\r\n            states.showDrafts = false;\r\n          }}\r\n        >\r\n          <Drafts onClose={() => (states.showDrafts = false)} />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showMediaModal && (\r\n        <Modal\r\n          onClick={(e) => {\r\n            if (\r\n              e.target === e.currentTarget ||\r\n              e.target.classList.contains('media')\r\n            ) {\r\n              states.showMediaModal = false;\r\n            }\r\n          }}\r\n        >\r\n          <MediaModal\r\n            mediaAttachments={snapStates.showMediaModal.mediaAttachments}\r\n            instance={snapStates.showMediaModal.instance}\r\n            index={snapStates.showMediaModal.index}\r\n            statusID={snapStates.showMediaModal.statusID}\r\n            onClose={() => {\r\n              states.showMediaModal = false;\r\n            }}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showShortcutsSettings && (\r\n        <Modal\r\n          onClose={() => {\r\n            states.showShortcutsSettings = false;\r\n          }}\r\n        >\r\n          <ShortcutsSettings\r\n            onClose={() => (states.showShortcutsSettings = false)}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showGenericAccounts && (\r\n        <Modal\r\n          onClose={() => {\r\n            states.showGenericAccounts = false;\r\n          }}\r\n        >\r\n          <GenericAccounts\r\n            instance={snapStates.showGenericAccounts.instance}\r\n            excludeRelationshipAttrs={\r\n              snapStates.showGenericAccounts.excludeRelationshipAttrs\r\n            }\r\n            onClose={() => (states.showGenericAccounts = false)}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showMediaAlt && (\r\n        <Modal\r\n          onClose={(e) => {\r\n            states.showMediaAlt = false;\r\n          }}\r\n        >\r\n          <MediaAltModal\r\n            alt={snapStates.showMediaAlt.alt || snapStates.showMediaAlt}\r\n            lang={snapStates.showMediaAlt?.lang}\r\n            onClose={() => {\r\n              states.showMediaAlt = false;\r\n            }}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showEmbedModal && (\r\n        <Modal\r\n          class=\"solid\"\r\n          onClose={() => {\r\n            states.showEmbedModal = false;\r\n          }}\r\n        >\r\n          <EmbedModal\r\n            html={snapStates.showEmbedModal.html}\r\n            url={snapStates.showEmbedModal.url}\r\n            width={snapStates.showEmbedModal.width}\r\n            height={snapStates.showEmbedModal.height}\r\n            onClose={() => {\r\n              states.showEmbedModal = false;\r\n            }}\r\n          />\r\n        </Modal>\r\n      )}\r\n      {!!snapStates.showReportModal && (\r\n        <Modal\r\n          onClose={() => {\r\n            states.showReportModal = false;\r\n          }}\r\n        >\r\n          <ReportModal\r\n            account={snapStates.showReportModal.account}\r\n            post={snapStates.showReportModal.post}\r\n            onClose={() => {\r\n              states.showReportModal = false;\r\n            }}\r\n          />\r\n        </Modal>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"],"names":["Accounts","onClose","masto","api","accounts","store","local","getJSON","currentAccount","session","get","moreThanOneAccount","length","_","reload","useReducer","x","accountsListParent","useAutoAnimate","_jsxs","id","class","tabIndex","children","_jsx","type","onClick","Icon","icon","ref","map","account","i","isCurrent","info","isDefault","alt","Avatar","url","avatarStatic","size","onDblClick","v1","$select","fetch","log","NameText","test","showAcct","states","set","_Fragment","Menu2","align","menuButton","title","MenuItem","MenuDivider","disabled","splice","MenuConfirm","subMenu","confirmLabel","menuItemClassName","href","Link","to","define_import_meta_env_default","useLocationChange","fn","location","useLocation","currentLocationRef","useRef","pathname","useEffect","current","AccountSheet","instance","propInstance","authenticated","isString","AccountInfo","fetchAccount","lookup","acct","skip_webfinger","result","v2","search","q","limit","resolve","accountURL","URL","hostname","replace","Drafts","uiState","setUIState","useState","drafts","setDrafts","reloadCount","c","keys","db","ns","getCurrentAccountNS","ownKeys","filter","key","startsWith","getMany","sort","a","b","Date","updatedAt","getTime","console","hasDrafts","Loader","abrupt","hidden","draft","draftStatus","replyTo","updatedAtDate","alert","replyToStatus","window","MiniDraft","poll","status","spoilerText","mediaAttachments","hasPoll","options","hasMedia","firstImageMedia","media","image","file","objectURL","createObjectURL","hasPollOrMedia","style","EmbedModal","html","width","height","target","rel","dangerouslySetInnerHTML","__html","GenericAccounts","excludeRelationshipAttrs","currentInstance","isCurrentInstance","snapStates","useSnapshot","setAccounts","showMore","setShowMore","showGenericAccounts","heading","fetchAccounts","staticAccounts","showReactions","relationshipsMap","setRelationshipsMap","loadRelationships","relationships","fetchRelationships","loadAccounts","firstLoad","done","value","Array","isArray","theAccount","find","j","_types","push","prev","newAccounts","_a","reloadGenericAccounts","tabindex","relationship","_b","reblog","favourite","AccountBlock","showStats","InView","MediaAltModal","lang","forceTranslate","setForceTranslate","targetLanguage","getTranslateTargetLanguage","contentTranslationHideLanguages","settings","differentLanguage","localeMatch","l","supportsTTS","speak","dir","whiteSpace","textWrap","TranslationBlock","sourceLanguage","text","CATEGORIES","CATEGORIES_INFO","spam","label","description","legal","violation","stampLabel","other","excludeStamp","ReportModal","post","username","domain","split","rules","currentDomain","useMemo","getCurrentInstance","selectedCategory","setSelectedCategory","showRules","setShowRules","rulesRef","hasRules","setHasRules","Status","previewMode","avatarSize","useAvatarStatic","showActivity","onSubmit","e","preventDefault","formData","FormData","entries","Object","fromEntries","category","comment","forward","undefined","ruleIds","reports","accountId","statusIds","showToast","error","Fragment","name","rule","required","checked","for","maxlength","rows","subscribe","changes","action","path","prevValue","focusDeck","Modals","navigate","useNavigate","showCompose","Modal","Compose","__COMPOSE__","editStatus","results","newStatus","reloadStatusPage","reply","edit","delay","duration","toast","hideToast","prevLocation","showSettings","Settings","showAccounts","showAccount","destination","showDrafts","showMediaModal","currentTarget","classList","contains","MediaModal","index","statusID","showShortcutsSettings","ShortcutsSettings","showMediaAlt","showEmbedModal","showReportModal"],"mappings":"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"}